# Web Application Analysis 

Since technology is using more web technologies, the risk and complexity of exposing data increases. To insure that the entire web infrastructure is safe requires both the web application front-end and the databases back-end security countermeasures. 

## Web Application Assesment 

The front-end of the web infrastructure is responsible for identifying, analyzing, and exploiting the vulnerabilities in application security. 

It includes: 

1. Cross-site Scripting (XSS) 
2. SQL Injection 
3. SSI Injection 
4. XML injection


### Web Application Proxies - burpsuite

The burpsuite tool is and interception proxy that can be used on an internet browser to route traffic. It captures each request from the target web application in order to analyze them. burpsuite can be especially useful to find an SQL injection vulnerablity.

The important integrated tools it contains: 

1. Target
2. Proxy 
3. Spider
4. Scanner
5. Intruder 
6. Repeater

#### Target Scope

This scope is to tell burpsuite what domain it is going to be testing. Configuring using the Target scope allows for a more specified test. 

1. Clairify what you want to add and exclude from the web application. 
    - Can be a single domain,folders, or path
    - Can configure multiple at a time
    - Can exclude functionality out of the scope
    - Can exclude fragile functionalities (admin )
    - Can exclude functionalities that could kill the session, deleting your account, etc (logout) 
**Using advanced scope control allows you to create scope rules with a protocol, host/IP range, port, or a specifc file** 

2. After you configure your target scope and go to perform a scan, you can configure your crawl options to allow site resources from out of scope hosts.

#### Proxy Scope 

The purpose of the proxy scope is to monitor and intercep all requests and responses from the user driven workflow that is supported by burpsuite. It defaults to creating a single listener on port 8080. 

 Starting out with the intercept tab on the proxy scope, you can open a preconfigured browser that works with burpsuite. 
        - Write the domain in the search bar and the request packet appear in burp. 
        - You can edit the request, perform vulnerability scans, or drop the packet

#### Spider Scope 

THe purpose of the spider scope is to map applications large applications automatically making it faster and more efficient. 

1. After configuring the target scope, interact with the URL in the browser or use a curl command to send traffic to the given URL. 
2. This should bring you to the proxy intercepting, of which you can send to the spider scope to web out
3. Review the Site Map. 
curl -x localhost:8080 [URL] # The curl command for the first spider step
#### Scanner Scope

The scanner scope is used to automatically find security vulnerabilities. The scope has two modes, active and passive. 

**Passive:**
    > The scanner doesn't send any new requests when it operates on a purely passive mode. 
    > It is the default of burp to carry out passive scanning 
    > Remember to alwawys reconfigure the passive scanning settings to stay in the target scope previously configured. 

**Active** 
    > burp sends various requests to the web application, then analyzes. 
    > has the ability to identify a wider range of vulnerabilities
   

#### Repeater Scope

The repeater lets you manually modify individual requests and tamper away. It also contains links to make it easier to repeat the attack in the browser very quickly.  

#### Intruder Scope

The intruder tool allows you to  copy multiple login requests into the repeater tool and automatically selects the username and password to replace every time. 

### Web Crawlers

This program/automated script browses the entire OSINT ,and the primary goal of a web crawler is to try and learn every webpage on the web. I.E a search engine.

#### dirb 

A commmand-line based tool that brute forces a directory based on a wordlist. Internally dirb has a wordlist file that by default, has around 4000 words. dirb aims to access files and directories stored on the outside of the web root folder. dirb also manipulates variable through reference files with (.../) sequences to enable the possibility of access to application souce code, configuration, and critical system files. 
dirb <URL> 
When finished dirb reports the number of objects found and using the **-o** parameter an output file can be created and the results saved. 
cd /usr/share/dirb/wordlists/vuln # use specific wordlists to find vulnerable objects 
ls -l # prints
/usr/share/dirb/wordlists/vuln/<web server name> # run dirb 
#### wfuzz

The tool wfuzz allows input of any kind to be injecte in nay part of the HTTP request, thus performing web security attacks that are more complex in different web application components such as;

1. Parameters
2. Authentication 
3. Forms
4. Directories/Files 
5. Headers


The main differnce between wfuzz and burpsuite is the simpler language interface that wfuzz allows for. Because of this, the Pentester has more control over understanding what they are doing rather than rely on the web scanner's implementation.

Types of Vulnerabilities wfuzz tests for:

1.  Discovery of important web pages that don’t provide proper access control (like admin panels or configuration files)

2. Injection based vulnerabilities, such as directory traversals, SQL injections, XSS injections, and XXE injections

3. Brute forcing common credentials

4. Known open source vulnerabilities, such as apache and sharepoint based attacks
wfuzz -w wordlist/general/common.txt http://testphp.vulnweb.com/FUZZ
The example command above specifies the wordlist used to brute force the directories or files, then included is the target website along with the FUZZ keyword. 
Wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d “username=admin&password=FUZZ” -u <TARGET_URL>
The example command above is used when intercepting a SQL packet through burpsuite. **"username=admin&password=FUZZ"** is the format found from the interception of the packet, wfuzz can then send post requests successfully. 

### Web Vulnerability Scanners 

#### nikto 

Nikto is an open source platform that runs on a Perl friendly enviornment that allows pentesters to examine the web server for problems such as;

1. Server and Software misconfigurations
2. Default and Insecure files and programs
3. Outdated servers and programs 



##### nikto important  Features to note

**-Cgidirs:** This option is used to scan specified CGI directories. Users can filter “none” or “all” to scan all CGI directories or none. 

**-config:** This option allows the pentester, hacker, or developer to specify an alternative config file to use instead of the config.txt located in the install directory.

**-Display:** output control: 

**1** - Show redirects

**2** – Show cookies received

**3** – Show all 200/OK responses

**4** – Show URLs which require authentication

**D** – Debug Output

**V** – Verbose Output

**-evasion:**  specify what type of evasion techniques are going to be used. Multiple number references may be used:

1 – Random URI encoding (non-UTF8)

2 – Directory self-reference (/./)

3 – Premature URL ending

4 – Prepend long random string

5 – Fake parameter

6 – TAB as request spacer

7 – Change the case of the URL

8 – Use Windows directory separator ()

##### Basic syntax
nikto -h http://webscantest.com 
or
nikto -h http://webscantest.com -ssl # for an SSL-Enabled Website
#### cadaver

The tool cadaver is just used to enable the uploading and downloading of a file on WebDAV. 

**WebDAV** : a protocol that enables users to edit, share, copy, and move files on a web server. 
cadaver http:// <IP Address> /dav/ 
After running the command you can run the URL to check if the file is uploaded. 

#### wapiti 

Just another web vulnerability scanner with the ability to detect these vulnerabilities

1. File disclosure (Local and remote include/require, fopen, readfile...)
2. Database Injection (PHP/JSP/ASP SQL injections and XPath injections)
3. XSS (Cross-Site Scripting) injection (reflected and permanent)
4. Command Execution detection (eval(), system(), passtru()...)
5. CRLF Injection (HTTP Response Splitting, session fixation...)
6. XXE (XML External Entity) injection
7. **Use of known potentially dangerous files (thanks to the Nikto database)**
8. Weak .htaccess configurations that can be bypassed
9. Presence of backup files providing sensitive information (source code disclosure)
10. Shellshock (aka Bash bug)
wapiti https://testphp.vulnweb.com/ -o wapiti_output --verify-ssl 0 -n 20 2>null 
This command lets you see the output in a web server with the given html file. 

#### whatweb 

The keypoint in using this tool is the nature of it being non-intrusive. It is still semi-passive due to the fact that the pentester is still sending packets to the target, however the packets **WON'T** be detected as anything other that a regular web page request. 

Identifies information such as: 

1. Platform
2. CMS platform
3. Type of Script
4. Google Analytics
5. Web server Platform
6. IP address, Country
7. 900+ Plugins & their libraries used
8. Server Headers, Cookies and a lot more.
whatweb [options] <URLs> # syntax
### CMS & Framework Identifiers 

##### What is Framework? 

Framework is a library used to develop a web application without doing it from scratch. Includes frameworks of pre-written code such as; 

1. CodeIgniter
2. CakePHP
3. Zend
4. Django

##### What is CMS? 

A Content Management System is a web application built on top of a framework that manages the content for the users to perform actions such as, installing themes or managing plugins. All of this without effecting the functionality of the site, therefore not requiring coding knowlege. Important thing to note is that CMS is **Open Source**. 


### WPScan 

WPScan just identifies vulnerabilities such as;

1. Vulnerabilities in WordPress version
2. Theme and Plug-ins known to be vulnerable
3. Timthumbs ( resizing script ) 
4. Checking for configuration backups and Database exports
5. Brute Force Attacks
wpscan -- url <Insert url> 
## Database Assesment

The back-end Database tools are responsible for fingerprinting, enumeration, password auditing, assesing the target with SQL injection attacks, which is allows pentesters to get a better view of the weaknesses in the front-end web application assessment. 

### SQLite database

A library constructed in C, that implements a SQL database engine. It doesn't implement the client-server model doesn't have standalone processes. The library is linked into the applicaiton program, allowing it to be static or dynamic. 

Important things to note: 

1. Being Server-less means no start-up scripts or service management 
2. Access Control is handled by **file-system permissions** 
3. The **ENTIRE** database is stored withing a single cross-platform file on the host machine. 
4. It doesn't enforce type checking // the type of value is dynamic and not constricted to the schema 

### sqlmap 

An automatic SQL injection tool that scans, detects, and exploirs the SQL injection flaws from the given URL. Currently it supports Database Management Systems such as;

1. MS-SQL 
2. MySQL 
3. Oracle
4. Postgre SQL 

Capable of identifying database systems such as; 

1. DB2
2. Informix
3. Sybase 
4. InterBase 
5. MS-Access

The four SQL techniques it employs: 

1. Inferential blind SQL Injection
2. UNION query SQL injection 
3. Stacked queries
4. Time-based blind SQL Injection 

##### List information about the existing databases
 sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 --dbs 
##### List information about Tables inside a specific database
 sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D acuart --tables 
##### List information about the columns of a table
 sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D acuart -T artists --columns 
##### Dump the data 
 sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D acuart -T artists -C aname --dump 